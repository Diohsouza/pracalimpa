<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Assistente de Rapport – New Life</title>
  <style>
    :root{
      --bg:#0b0f14;--card:#111827;--muted:#6b7280;--txt:#eef2ff;--pri:#22c55e;--pri-2:#16a34a;--chip:#0f172a;--accent:#38bdf8;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b0f14,#0b0f14 40%,#0e1520);color:var(--txt);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    header{display:flex;gap:12px;justify-content:space-between;align-items:center;margin-bottom:18px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:38px;height:38px;border-radius:12px;background:radial-gradient(120% 120% at 20% 20%,#4ade80,transparent 40%),radial-gradient(120% 120% at 80% 20%,#22d3ee,transparent 40%),radial-gradient(120% 120% at 50% 80%,#a78bfa,transparent 40%);box-shadow:0 0 0 2px #111827}
    h1{font-size:18px;margin:0;font-weight:700;letter-spacing:.2px}
    .subtitle{font-size:12px;color:var(--muted)}
    .card{background:linear-gradient(180deg,#0f172a,#0b1220);border:1px solid #122032;border-radius:16px;padding:16px;box-shadow:0 8px 30px rgba(0,0,0,.25)}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:#0c1220;border:1px solid #1b2a3c;color:#bcd3ff;font-size:12px}
    .grid{display:grid;gap:10px}
    @media(min-width:640px){.grid.sm-3{grid-template-columns:repeat(3,1fr)}.grid.sm-4{grid-template-columns:repeat(4,1fr)}.grid.sm-5{grid-template-columns:repeat(5,1fr)}}
    .btn{border:1px solid #22334a;background:#0c1624;color:#cfe6ff;border-radius:12px;padding:10px 12px;font-weight:600;cursor:pointer;transition:.25s;box-shadow:inset 0 0 0 0 var(--pri)}
    .btn:hover{transform:translateY(-1px);border-color:#2e4666}
    .btn.primary{background:linear-gradient(180deg,var(--pri),var(--pri-2));border-color:transparent;color:#05130a}
    .btn.ghost{background:#0c1220;border-color:#1b2a3c;color:#9fb5d6}
    .btn.small{padding:7px 10px;border-radius:10px;font-size:12px}
    .toolbar{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin:12px 0}
    .search{flex:1;min-width:200px}
    input[type="text"], textarea{width:100%;background:#0b1220;border:1px solid #1b2a3c;border-radius:12px;color:#dbe7ff;padding:10px 12px;outline:none}
    textarea{min-height:120px;resize:vertical}
    .muted{color:#92a7c7}
    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip{background:#0b1220;border:1px solid #203046;color:#cfe6ff;padding:8px 12px;border-radius:999px;font-size:12px;cursor:pointer}
    .chip.active{background:#10253a;border-color:#2d4f78}
    .progress{height:8px;border-radius:999px;background:#0b1220;border:1px solid #1b2a3c;overflow:hidden}
    .progress>span{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#60a5fa);width:0%}
    .cols{display:grid;gap:12px}
    @media(min-width:900px){.cols{grid-template-columns:1.1fr .9fr}}
    .section-title{display:flex;align-items:center;justify-content:space-between;margin:6px 0 10px}
    .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;background:#0b1220;border:1px solid #1b2a3c;border-bottom-color:#122032;border-radius:8px;padding:2px 6px;font-size:11px;color:#9bb8e2}
    .list{display:flex;flex-direction:column;gap:10px}
    .item{background:#0b1220;border:1px solid #132235;border-radius:12px;padding:12px}
    .item h4{margin:0 0 6px 0}
    .state-grid{display:grid;gap:8px;grid-template-columns:repeat(2,1fr)}
    @media(min-width:640px){.state-grid{grid-template-columns:repeat(4,1fr)}}
    .state-btn{padding:10px;border-radius:10px;background:#0c1624;border:1px solid #1b2a3c;cursor:pointer;color:#cfe6ff;text-align:left}
    .state-btn:hover{border-color:#2a4466}
    .footer{margin-top:24px;display:flex;gap:10px;flex-wrap:wrap}
    .tip{font-size:12px;color:#8aa6d4}
    .badge{display:inline-flex;gap:6px;align-items:center;background:#0c1624;border:1px solid #1b2a3c;border-radius:999px;padding:6px 10px;font-size:12px;color:#bcd3ff}
    .ghost-sep{border-top:1px dashed #203046;margin:14px 0}
    .sr{position:absolute;left:-9999px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Assistente de Rapport – New Life</h1>
          <div class="subtitle">Guia rápido para ligação: <span class="muted">Estado → Motivo da negativação → Objetivo do cliente</span></div>
        </div>
      </div>
      <div class="toolbar">
        <button class="btn ghost small" id="btnPromptMaster">Prompt mestre</button>
        <button class="btn primary small" id="btnCopiarResumo">Copiar resumo</button>
      </div>
    </header>

    <div class="card" id="wizard">
      <div class="progress" aria-hidden="true"><span id="bar"></span></div>
      <div class="toolbar" style="margin-top:12px">
        <span class="badge">Passo <strong id="stepNum">1</strong>/3</span>
        <div class="pill">Dica: use <span class="kbd">Ctrl</span> + <span class="kbd">F</span> para achar rápido</div>
        <div class="search"><input id="search" type="text" placeholder="Pesquisar estado, mania, prato típico, time, festa…"/></div>
        <div style="margin-left:auto;display:flex;gap:8px">
          <button class="btn ghost small" id="prev">◀ Voltar</button>
          <button class="btn primary small" id="next">Avançar ▶</button>
        </div>
      </div>

      <div class="cols">
        <!-- LADO A: INTERAÇÃO -->
        <section>
          <div class="section-title">
            <h3 id="sectionTitle">1) Escolha o estado do cliente</h3>
          </div>

          <!-- PASSO 1: ESTADOS -->
          <div id="step1">
            <div class="state-grid" id="stateGrid"></div>
            <div class="ghost-sep"></div>
            <div class="list" id="stateTips"></div>
          </div>

          <!-- PASSO 2: MOTIVO DA NEGATIVAÇÃO -->
          <div id="step2" style="display:none">
            <div class="chips" id="motivosChips"></div>
            <div class="ghost-sep"></div>
            <div class="list" id="motivoSugestoes"></div>
          </div>

          <!-- PASSO 3: OBJETIVO DO CLIENTE -->
          <div id="step3" style="display:none">
            <div class="chips" id="objetivosChips"></div>
            <div class="ghost-sep"></div>
            <div class="list" id="objetivoSugestoes"></div>
          </div>
        </section>

        <!-- LADO B: ROTEIROS & PROMPT GERADO -->
        <aside>
          <div class="item">
            <h4>Resumo da ligação</h4>
            <div class="muted" id="resumoMini">Nenhuma seleção ainda.</div>
          </div>

          <div class="item">
            <h4>Abertura sugerida</h4>
            <div id="aberturaBox" class="muted">Escolha um estado para ver uma abertura contextualizada.</div>
          </div>

          <div class="item">
            <h4>Empatia pelo motivo</h4>
            <div id="empatiaBox" class="muted">Selecione um motivo para destravar uma frase de empatia verdadeira.</div>
          </div>

          <div class="item">
            <h4>Transição para objetivo</h4>
            <div id="transicaoBox" class="muted">Selecione um objetivo do cliente para uma transição com CTA.</div>
          </div>

          <div class="item">
            <h4>Prompt para IA (gerar roteiro completo)</h4>
            <textarea id="promptIA" readonly></textarea>
            <div class="footer">
              <button class="btn ghost small" id="copiarPrompt">Copiar prompt</button>
              <span class="tip">Cole no ChatGPT para receber um roteiro personalizado em segundos.</span>
            </div>
          </div>
        </aside>
      </div>
    </div>

    <div class="card" id="modalPrompt" style="display:none;position:fixed;inset:10%;z-index:50">
      <div style="display:flex;justify-content:space-between;gap:10px;align-items:center;margin-bottom:10px">
        <strong>Prompt mestre (edite como quiser)</strong>
        <button class="btn small ghost" id="fecharModal">Fechar</button>
      </div>
      <textarea style="min-height:220px" id="promptMestre"></textarea>
      <div class="footer">
        <button class="btn small ghost" id="copiarMestre">Copiar</button>
        <span class="tip">Use este prompt para gerar variações de scripts, objeções e follow-ups.</span>
      </div>
    </div>

    <footer style="margin-top:14px;display:flex;justify-content:space-between;align-items:center">
      <span class="muted">© New Life – Ferramenta de apoio ao consultor</span>
      <span class="muted">Atalho: <span class="kbd">Alt</span> + <span class="kbd">→</span>/<span class="kbd">←</span> para avançar/voltar</span>
    </footer>
  </div>

  <script>
    // ====== DADOS ======
    const estados = [
      {uf:'AC',nome:'Acre', dicas:[
        'Pergunte se é de Rio Branco ou interior; mencione a BR-364 como referência.','Fale do clima amazônico e do cuidado com cheias.','Mostre interesse por culinária local: tacacá, tambaqui.']},
      {uf:'AL',nome:'Alagoas', dicas:[
        'Maceió e o litoral de águas claras são um ótimo gancho.','Maragogi e São Miguel dos Milagres costumam gerar conexão imediata.','Times locais e forró/piseiro rendem papo leve.']},
      {uf:'AP',nome:'Amapá', dicas:[
        'Macapá à beira do Equador é um diferencial curioso.','Pergunte sobre a Fortaleza de São José ou balneários.','Mencione respeito à cultura ribeirinha e marabaixo.']},
      {uf:'AM',nome:'Amazonas', dicas:[
        'Teatro Amazonas e Encontro das Águas são ganchos elegantes.','Cite o Festival de Parintins (Garantido/Caprichoso).','Valorize a logística e distâncias do estado.']},
      {uf:'BA',nome:'Bahia', dicas:[
        'Abra falando da energia de Salvador ou do interior (Chapada Diamantina).','Comida típica: acarajé, moqueca – evite estereótipos, vá com respeito.','Axé, samba-reggae e São João são assuntos quentes.']},
      {uf:'CE',nome:'Ceará', dicas:[
        'Fortaleza, Jericoacoara, Canoa Quebrada – litoral sempre conecta.','Humor cearense e vaquejada podem entrar com leveza.','Times: Ceará e Fortaleza (pergunte com respeito!).']},
      {uf:'DF',nome:'Distrito Federal', dicas:[
        'Brasília: superquadras, eixos, parques (Água Mineral).','Trânsito e burocracias federais como quebra-gelo.','Muitas pessoas são de outros estados – pergunte de onde veio.']},
      {uf:'ES',nome:'Espírito Santo', dicas:[
        'Moqueca capixaba vs baiana? Trate com humor respeitoso.','Vitória, Vila Velha e o Convento da Penha como ganchos.','Café e rochas ornamentais são temas profissionais comuns.']},
      {uf:'GO',nome:'Goiás', dicas:[
        'Goiânia e sertanejo/universitário rendem conexão.','Pequi e comida goiana – cite como curiosidade.','Agronegócio e chapadas (Veadeiros) como temas.']},
      {uf:'MA',nome:'Maranhão', dicas:[
        'Lençóis Maranhenses é sempre bom assunto.','Cultura do bumba meu boi e reggae maranhense.','Gastronomia: arroz de cuxá, juçara.']},
      {uf:'MT',nome:'Mato Grosso', dicas:[
        'Chapada dos Guimarães e calor forte – empatia.','Agronegócio e Pantanal mato-grossense.','Distâncias grandes entre cidades; logística é tema.']},
      {uf:'MS',nome:'Mato Grosso do Sul', dicas:[
        'Bonito e Pantanal rendem papo positivo.','Tereré e influência paraguaia são referências locais.','Campo Grande: ruas largas e qualidade de vida.']},
      {uf:'MG',nome:'Minas Gerais', dicas:[
        'Pão de queijo, café e hospitalidade mineira (sem clichê excessivo).','Cidades históricas (Ouro Preto, Tiradentes).','Futebol: Galo, Cruzeiro, América – cuidado para não polarizar.']},
      {uf:'PA',nome:'Pará', dicas:[
        'Belém, Círio de Nazaré – trate com respeito religioso.','Culinária forte: tacacá, açaí “raiz”, maniçoba.','Clima úmido e chuvas – mostre empatia.']},
      {uf:'PB',nome:'Paraíba', dicas:[
        'João Pessoa, pôr do sol do Jacaré; praias e segurança.','São João de Campina Grande.','Rapadura, buchada e artesanato local.']},
      {uf:'PR',nome:'Paraná', dicas:[
        'Curitiba e seu planejamento urbano.','Cataratas do Iguaçu; mate/ chimarrão em parte do estado.','Clima frio no interior – empatia.']},
      {uf:'PE',nome:'Pernambuco', dicas:[
        'Recife/Olinda, frevo e maracatu.','Porto de Galinhas e litoral sul.','Gastronomia: bolo de rolo, carne de sol.']},
      {uf:'PI',nome:'Piauí', dicas:[
        'Delta do Parnaíba e Parque Serra da Capivara.','Teresina e o calor intenso – empatia genuína.','Cultura: carnaubais, artesanato, forró.']},
      {uf:'RJ',nome:'Rio de Janeiro', dicas:[
        'Praias, Cristo, Pão de Açúcar – mas evite clichês forçados.','Trânsito e deslocamento: empatia na rotina.','Futebol (Fla/Flu/Bota/Vasco) com cuidado para não rivalizar.']},
      {uf:'RN',nome:'Rio Grande do Norte', dicas:[
        'Natal, Pipa e Genipabu – dunas e passeios.','Cajueiro de Pirangi como curiosidade.','Frutos do mar e calor litorâneo.']},
      {uf:'RS',nome:'Rio Grande do Sul', dicas:[
        'Chimarrão, churrasco e Serra Gaúcha – cite com respeito.','Dupla Gre-Nal (cuidado para não provocar).','Clima frio e trabalho no interior/agronegócio.']},
      {uf:'RO',nome:'Rondônia', dicas:[
        'Porto Velho, Madeira-Mamoré (história ferroviária).','Mistura cultural norte/nordeste/centro-oeste.','Cite calor e distâncias – empatia.']},
      {uf:'RR',nome:'Roraima', dicas:[
        'Boa Vista planejada, Monte Roraima.','Fronteira com Guiana/Venezuela – diversidade cultural.','Clima e logística peculiares – demonstre respeito.']},
      {uf:'SC',nome:'Santa Catarina', dicas:[
        'Praias, serra e Oktoberfest (Blumenau).','Colonização europeia e culinária variada.','Times locais e qualidade de vida nas cidades médias.']},
      {uf:'SP',nome:'São Paulo', dicas:[
        'Trânsito, trabalho e gastronomia do mundo todo.','Bairros e cidades do interior (Campinas, Ribeirão, Sorocaba).','Futebol (Corinthians/Palmeiras/São Paulo/Santos) – trate com leveza.']},
      {uf:'SE',nome:'Sergipe', dicas:[
        'Aracaju, orla bonita e qualidade de vida.','Cânion do Xingó e forró sergipano.','Caranguejo e culinária litorânea.']},
      {uf:'TO',nome:'Tocantins', dicas:[
        'Jalapão como cartão postal – águas e dunas.','Palmas e seu urbanismo recente.','Clima seco/quente – empatia real.']},
    ];

    const motivos = [
      'Desemprego','Emprestou o nome','Pandemia/queda de renda','Divórcio/separação','Falência/fechou empresa','Doença na família','Golpe/estelionato','Atraso pontual que virou bola de neve','Emergência médica','Nascimento de filho','Morte na família','Dependência química na família','Mudança de cidade','Erro cadastral/negativação indevida','Compras impulsivas','Cartão estourado/rotativo','Consignado acumulado','Empréstimos múltiplos','Foi avalista','Atraso com aluguel','Atraso com escola dos filhos','Atraso com plano de saúde','MEI desorganizado','Autônomo sazonal','Perda de cliente-chave','Recuperação judicial','Crédito negado repetidas vezes','Endividamento bancário','Cheque especial/limite','Outros'
    ];

    const objetivos = [
      'Financiamento de moto','Financiamento de carro','Financiamento de casa','Cartão de crédito','Empréstimo pessoal','Alugar imóvel','Abrir empresa/MEI','Aprovar limite no banco','Crediário em lojas','Conta de luz/água no nome','Plano de celular/TV','Financiar equipamento de trabalho','Vender no marketplace','Consórcio','Crédito rural','Cartão sem anuidade','Regularizar CNPJ','Outros'
    ];

    // Sugestões dinâmicas por motivo/objetivo
    const empatiaPorMotivo = {
      'Desemprego':'Sinto muito pelo período difícil. Vamos organizar tudo para você voltar a ter crédito e respirar aliviado, passo a passo. Eu cuido da burocracia, você foca em recomeçar.',
      'Emprestou o nome':'Isso acontece mais do que parece, e dói mesmo. Sem julgamento: vamos concentrar no que dá pra resolver agora e blindar para não se repetir.',
      'Pandemia/queda de renda':'Muita gente foi afetada. A boa notícia é que existem caminhos legais para limpar e reconstruir seu histórico.',
      'Divórcio/separação':'Sei que é um turbilhão. A gente simplifica o financeiro para você tocar sua vida com mais paz.',
      'Falência/fechou empresa':'Empreender é arriscar. Bora virar a página com estratégia e crédito saudável.',
      'Doença na família':'Prioridade é saúde. Vamos aliviar o resto com um plano claro e prazos definidos.',
      'Golpe/estelionato':'Lamento muito. Vamos verificar o que cabe de contestação e focar na limpeza do que travou seu CPF.',
      'Atraso pontual que virou bola de neve':'Acontece rápido. A ideia é estancar agora e reorganizar pra não voltar.',
      'Outros':'Obrigado por confiar em contar. Vamos tratar com respeito e foco em solução.'
    }

    const transicaoPorObjetivo = {
      'Financiamento de moto':'Perfeito. Assim que seu nome estiver limpo, já te oriento a fortalecer score e renda comprovada para aprovar a moto sem dor de cabeça.',
      'Financiamento de carro':'Ótimo. Com CPF regular e score subindo, fica bem mais viável buscar taxas melhores no carro.',
      'Financiamento de casa':'Meta importante. Vamos limpar e preparar seu perfil financeiro para o crédito imobiliário.',
      'Cartão de crédito':'Com o nome limpo, alinhamos bancos que liberam primeiro e como usar sem cair no rotativo.',
      'Empréstimo pessoal':'Com a limpeza, avaliamos instituições com aprovação mais rápida e juros menores.',
      'Alugar imóvel':'Nome limpo abre portas com imobiliárias e seguro-fiança. Te mostro como reforçar comprovação.',
      'Abrir empresa/MEI':'Limpo o CPF e te mostro como começar o CNPJ já com perfil saudável.',
      'Aprovar limite no banco':'Depois da limpeza, trabalhamos limites progressivos e relacionamento bancário.',
      'Crediário em lojas':'Com o CPF ok, a aprovação em lojas melhora. Te passo a sequência certa para subir score.',
      'Vender no marketplace':'Limpeza ajuda a abrir conta PJ/MEI e meios de pagamento sem bloqueios.',
      'Consórcio':'Com nome limpo, a carta sai com menos atrito e melhor negociação.',
      'Crédito rural':'Após limpar, organizamos documentos e renda para linhas específicas do agro.',
      'Regularizar CNPJ':'Tirando os bloqueios no CPF, fica mais fácil ajustar pendências do CNPJ.',
      'Outros':'Com o nome limpo, alinhamos os próximos passos para seu objetivo acontecer.'
    }

    // ====== ESTADO ======
    const stateGrid = document.getElementById('stateGrid');
    const stateTips = document.getElementById('stateTips');
    const search = document.getElementById('search');

    let selecionado = { estado:null, motivo:null, objetivo:null };
    let passo = 1;

    function renderEstados(filtro=''){
      stateGrid.innerHTML='';
      const lista = estados.filter(e=> (e.nome+e.uf+e.dicas.join(' ')).toLowerCase().includes(filtro.toLowerCase()));
      lista.forEach(({uf,nome,dicas})=>{
        const b=document.createElement('button');
        b.className='state-btn';
        b.innerHTML=`<strong>${nome}</strong><br><span class="muted">${uf}</span>`;
        b.onclick=()=>{ selecionado.estado={uf,nome}; mostrarDicasEstado({uf,nome,dicas}); atualizarResumo(); };
        stateGrid.appendChild(b);
      });
    }

    function mostrarDicasEstado({uf,nome,dicas}){
      stateTips.innerHTML='';
      const head = document.createElement('div');
      head.className='item';
      head.innerHTML = `<h4>${nome} (${uf})</h4><div class="muted">Pautas de conexão:</div>`;
      stateTips.appendChild(head);
      dicas.forEach((d)=>{
        const it=document.createElement('div');
        it.className='item';
        it.innerHTML=`<div>${d}</div>`;
        stateTips.appendChild(it);
      });
      document.getElementById('aberturaBox').innerHTML = `Oi, tudo bem? Vi aqui que você é de <strong>${nome}</strong>. Eu adoro ${dicas[0].replace(/\.$/,'')} – e sei como é a rotina por aí. Podemos alinhar rapidinho como deixar seu CPF em ordem?`;
    }

    // ====== MOTIVOS ======
    const motivosChips = document.getElementById('motivosChips');
    const motivoSugestoes = document.getElementById('motivoSugestoes');

    function renderMotivos(){
      motivosChips.innerHTML='';
      motivos.forEach(m=>{
        const c=document.createElement('button');
        c.className='chip'; c.textContent=m; c.onclick=()=>{selecionado.motivo=m; marcarChip(motivosChips,m); renderSugMotivo(m)};
        motivosChips.appendChild(c);
      })
    }
    function renderSugMotivo(m){
      motivoSugestoes.innerHTML='';
      const s = empatiaPorMotivo[m] || empatiaPorMotivo['Outros'];
      const it=document.createElement('div');
      it.className='item';
      it.innerHTML = `<div class="muted">Fala empática:</div><div><strong>"${s}"</strong></div>`;
      motivoSugestoes.appendChild(it);
      document.getElementById('empatiaBox').innerHTML = s;
      atualizarResumo();
    }

    // ====== OBJETIVOS ======
    const objetivosChips = document.getElementById('objetivosChips');
    const objetivoSugestoes = document.getElementById('objetivoSugestoes');

    function renderObjetivos(){
      objetivosChips.innerHTML='';
      objetivos.forEach(o=>{
        const c=document.createElement('button');
        c.className='chip'; c.textContent=o; c.onclick=()=>{selecionado.objetivo=o; marcarChip(objetivosChips,o); renderSugObjetivo(o)};
        objetivosChips.appendChild(c);
      })
    }
    function renderSugObjetivo(o){
      objetivoSugestoes.innerHTML='';
      const s = transicaoPorObjetivo[o]||transicaoPorObjetivo['Outros'];
      const it=document.createElement('div');
      it.className='item';
      it.innerHTML = `<div class="muted">Transição + CTA:</div><div><strong>"${s}"</strong></div>`;
      objetivoSugestoes.appendChild(it);
      document.getElementById('transicaoBox').innerHTML = s;
      atualizarResumo();
    }

    // ====== NAVEGAÇÃO ======
    const next = document.getElementById('next');
    const prev = document.getElementById('prev');
    const bar  = document.getElementById('bar');
    const stepNum = document.getElementById('stepNum');
    const sectionTitle = document.getElementById('sectionTitle');

    function setPasso(n){
      passo=n; stepNum.textContent=n;
      const pcts = {1:'0%',2:'50%',3:'100%'}; bar.style.width=pcts[n];
      document.getElementById('step1').style.display = n===1?'block':'none';
      document.getElementById('step2').style.display = n===2?'block':'none';
      document.getElementById('step3').style.display = n===3?'block':'none';
      sectionTitle.textContent = n===1? '1) Escolha o estado do cliente'
        : n===2? '2) Selecione o motivo da negativação'
        : '3) Defina o objetivo do cliente com o nome limpo';
    }

    next.onclick=()=>{ if(passo<3) setPasso(passo+1) };
    prev.onclick=()=>{ if(passo>1) setPasso(passo-1) };

    document.addEventListener('keydown',e=>{
      if(e.altKey && e.key==='ArrowRight') next.click();
      if(e.altKey && e.key==='ArrowLeft') prev.click();
    });

    // ====== SELEÇÃO & PROMPT ======
    function marcarChip(container, texto){
      [...container.children].forEach(x=>x.classList.toggle('active', x.textContent===texto));
    }

    function atualizarResumo(){
      const {estado,motivo,objetivo}=selecionado;
      const partes=[];
      if(estado) partes.push(`Estado: ${estado.nome} (${estado.uf})`);
      if(motivo) partes.push(`Motivo: ${motivo}`);
      if(objetivo) partes.push(`Objetivo: ${objetivo}`);
      document.getElementById('resumoMini').textContent = partes.length? partes.join(' · ') : 'Nenhuma seleção ainda.';
      gerarPromptIA();
    }

    function gerarPromptIA(){
      const {estado,motivo,objetivo}=selecionado;
      const e = estado? `${estado.nome} (${estado.uf})` : '—';
      const m = motivo || '—';
      const o = objetivo || '—';
      const abertura = document.getElementById('aberturaBox').innerText || '';
      const empatia  = document.getElementById('empatiaBox').innerText || '';
      const trans    = document.getElementById('transicaoBox').innerText || '';
      const prompt = `Atue como um consultor sênior da New Life criando um roteiro de ligação rápido (2 a 4 minutos) para gerar conexão e conversão.\n\nContexto:\n- Estado do cliente: ${e}\n- Motivo da negativação: ${m}\n- Objetivo com o nome limpo: ${o}\n\nPeças que já tenho (use como base e melhore):\n- Abertura contextualizada: ${abertura}\n- Frase de empatia: ${empatia}\n- Transição + CTA: ${trans}\n\nInstruções:\n1) Entregue um roteiro com: Abertura, Exploração rápida (3 perguntas-chave), Validação/Empatia, Explicação simples do processo, Provas sociais, Oferta e Fechamento com agenda de próximo passo.\n2) Use linguagem simples, segura, sem juridiquês, e mantenha tom humano.\n3) Adapte exemplos à realidade do estado informado.\n4) Sugira 2 variações de fechamento (cartão e boleto).\n5) Dê 3 respostas curtas para objeções comuns (preço, prazo, segurança).`;
      document.getElementById('promptIA').value = prompt;
    }

    // ====== BUSCA ======
    search.addEventListener('input',()=>{
      renderEstados(search.value);
    });

    // ====== BOTÕES DE CÓPIA ======
    const copiar = (id)=>{
      const el=document.getElementById(id);
      el.select(); el.setSelectionRange(0,99999);
      document.execCommand('copy');
    }
    document.getElementById('copiarPrompt').onclick=()=>copiar('promptIA');
    document.getElementById('btnCopiarResumo').onclick=()=>{
      const txt = document.getElementById('resumoMini').textContent + "\n\nAbertura: " + (document.getElementById('aberturaBox').innerText||'') + "\nEmpatia: " + (document.getElementById('empatiaBox').innerText||'') + "\nTransição: " + (document.getElementById('transicaoBox').innerText||'');
      navigator.clipboard.writeText(txt);
      alert('Resumo copiado!');
    }

    // ====== PROMPT MESTRE (MODAL) ======
    const modal = document.getElementById('modalPrompt');
    const btnMaster = document.getElementById('btnPromptMaster');
    const fecharModal = document.getElementById('fecharModal');
    const promptMestre = document.getElementById('promptMestre');

    btnMaster.onclick=()=>{ modal.style.display='block'; };
    fecharModal.onclick=()=>{ modal.style.display='none'; };

    promptMestre.value = `Você é um especialista em vendas por ligação da New Life. Gere um \"playbook de rapport e fechamento\" com base nos parâmetros que eu fornecer (estado do cliente, motivo da negativação e objetivo com nome limpo).\n\nEntregáveis obrigatórios:\n1) Abertura contextualizada ao estado (respeitosa, sem estereótipos).\n2) 3 perguntas de diagnóstico (rápidas) para entender contexto e urgência.\n3) Frase de empatia personalizada ao motivo da negativação.\n4) Explicação do processo New Life em 4 bullets (simples, sem juridiquês).\n5) 2 provas sociais curtas (estilo \"caso X\").\n6) Transição para o objetivo do cliente com CTA.\n7) 2 variações de fechamento (cartão e boleto) e reforço de segurança.\n8) 3 respostas curtas para objeções comuns (preço, prazo, segurança).\n\nFormato: títulos curtos, bullets enxutos e linguagem humana.`;

    document.getElementById('copiarMestre').onclick=()=>{
      promptMestre.select(); document.execCommand('copy'); alert('Prompt mestre copiado!');
    }

    // ====== INIT ======
    renderEstados(); renderMotivos(); renderObjetivos(); setPasso(1);
  </script>
</body>
</html>
